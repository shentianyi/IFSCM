<link rel="stylesheet"  type="text/css" href="/assets/delivery/supWaybill.css" />
<link rel="stylesheet" type="text/css" href="/assets/delivery/investory-receive.css"/>
<script src="/assets/deliery-send-receive.js" type="text/javascript"></script>
<div class="input-mix">
	<input type="text" name="delivery-up-tx" class="uploadfile" id="dnKey" value="<%= @params[:dnKey]%>"/>
	<select id="instore-type-index">
		<option value="0">全部</option>
		<option value="1">入库单</option>
		<option value="2">质检单</option>
	</select>
	仓库：<%= select_tag :wares,options_for_select(@wares)%>
	<input type="button" name="delivery-up-btn" class="btupload" value="提交" onclick="redirect_delivery_action('instore',{'type':document.getElementById('instore-type-index').selectedIndex});"  >
</div>
<div id="accept-list-div">
	<%if @msg
	if @msg.result%>
	<% items=@msg.object[1]%>
	<input type="hidden" value="<%= @msg.object[0].key%>" id="dnkey-hidden" name="dnKey">
	<table class="delivery-check">
		<tr  class="lineone">
			<th>&nbsp;</th>
			<th>箱号</th>
			<th>客户零件号</th>			
			<th>检验策略</th>
		    <th>运输状态</th>
			<th>是否异常</th>
			<th>已质检</th>
			<th>已入库</th>
			<th>库位</th>
		</tr>
		<% i=0%>
		<%
		items.each do |pack|
		%>
		<tr class="norline">
			<th><%= (i+=1)%></th>
			<th style="text-align:left;" id="pack-key-th-<%= pack.id%>"><%= pack.key%></th>
			<th style="text-align:center;"><%= pack.cpartNr%></th>
			<th>  <%= DeliveryHelper::get_pack_check_inspect(pack.needCheck)%> </th>
			<th>
			<div class="<%= DeliveryHelper::get_dn_wayState_css(pack.wayState)%>" id="waystate-th-<%= pack.id%>">
				<%= DeliveryHelper::get_dn_wayState(pack.wayState)%>
			</div></th>
			<th>
			<div class="<%= DeliveryHelper::get_delivery_obj_state_css(pack.state)%>" id="state-th-<%= pack.id%>">
				<%= DeliveryHelper::get_delivery_obj_state(pack.state)%>
			</div></th>
			<th><div  id="check-th-<%= pack.id%>"> <%= pack.checked ? "是":"否"%></div></th>	
			<th><div  id="store-th-<%= pack.id%>"> <%= pack.stored ? "是":"否"%></div></th>		
			 <th id="operate-th-<%= pack.id%>">
			 	<%if pack.can_instore%>
			<input id="<%= pack.id%>" type="input" class="pack-in-position-text"/>
			<%end%>
			</th>
		</tr>
		<%
		end%>
		</tr>
	</table>
	<div class="button-group">
		<input type="button" value="通过" onclick="pack_inspect(100,1);">
		<input type="button" value="未通过" onclick="pop_pack_inspect();">
	</div>
	<script type="text/javascript">
		var t=document.getElementById('instore-type-index')
		var i= <%= @params[:type].nil? ? 0 : @params[:type].to_i%>;		
		t.selectedIndex=i>t.length? 0 : i;
		var w=document.getElementById('wares');
		 i= <%= @params[:ware].nil? ? 0 : @params[:ware].to_i%>;	
		 	w.selectedIndex=i>w.length? 0 : i;
		var positions=$(".pack-in-position-text");
		if(positions.length>0){
		  positions[0].focus();
		}
	</script>
	<%= render :partial => "shared/handling_msg_box", :locals => { :handlemsg => "正在处理中，请稍后..." } %>

	<%else%>
	<div class="abstractblock">
		<%= @msg.content.html_safe%>
	</div>
	<%end
	end%>
</div>

